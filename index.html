<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>AR.js with Hiro Marker & 3D Model</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@ar-js-org/ar.js@3.4.6/aframe/build/aframe-ar.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; font-family: sans-serif; }
      #status {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        text-align: center;
        padding: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: #fff;
        z-index: 10;
        font-size: 14px;
      }
      /* Camera feed debugging styles */
      #camera-feed {
        display: none; /* Make sure the camera feed is hidden until everything is working */
      }
    </style>
  </head>
  <body>
    <div id="status">Loading... Point camera at the Hiro marker.</div>

    <a-scene
      embedded
      arjs="sourceType: webcam; debugUIEnabled: true; trackingMethod: best;"
      renderer="antialias: true;  preserveDrawingBuffer: true;"
      vr-mode-ui="enabled: false">

      <!-- Define your assets -->
      <a-assets>
        <!-- Make sure this URL points to a valid .glb model in your repository -->
        <a-asset-item id="3d-model" src="https://raw.githubusercontent.com/forevermidicom/YOUR_REPO/main/3D_model.glb"></a-asset-item>
      </a-assets>

      <!-- Hiro Marker -->
      <a-marker type="pattern" url="https://raw.githubusercontent.com/forevermidicom/YOUR_REPO/main/pattern-hiro.patt" id="hiro-marker">
        <!-- 3D model entity -->
        <a-entity id="3d-model" gltf-model="#3d-model" position="0 0.5 0" scale="0.5 0.5 0.5" visible="false"></a-entity>
      </a-marker>

      <!-- AR Camera -->
      <a-entity camera id="camera-feed"></a-entity>
    </a-scene>

    <script>
      window.addEventListener("DOMContentLoaded", () => {
        const marker = document.querySelector("#hiro-marker");
        const model = document.querySelector("#3d-model");
        const status = document.getElementById("status");

        marker.addEventListener("markerFound", () => {
          model.setAttribute("visible", "true");
          status.innerText = "Marker detected ✔ Model loaded.";
        });

        marker.addEventListener("markerLost", () => {
          model.setAttribute("visible", "false");
          status.innerText = "Marker lost ✖";
        });

        // Debugging: Console logging the camera feed and 3D model loading
        const cameraFeed = document.querySelector("#camera-feed");
        cameraFeed.addEventListener("loaded", () => {
          console.log("Camera feed loaded successfully.");
        });

        model.addEventListener('loaded', () => {
          console.log("3D model loaded successfully.");
        });

        // Initial loaded status
        document.querySelector("a-scene").addEventListener("loaded", () => {
          status.innerText = "Ready. Point at Hiro marker.";
        });
      });
    </script>
  </body>
</html>
